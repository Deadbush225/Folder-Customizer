#!/bin/bash
set -e
usage() { echo "Usage: fc-directory --folder PATH --tone (Dark|Light|Normal) --color COLOR [--tag TEXT]" >&2; }
for arg in "$@"; do
    case "$arg" in
        --folder=*) FOLDER="${arg#*=}" ;;
        --tone=*) TONE="${arg#*=}" ;;
        --color=*) COLOR="${arg#*=}" ;;
        --tag=*) TAG="${arg#*=}" ;;
    esac
done
[ -z "$FOLDER" ] && usage && exit 2
[ -z "$TONE" ] && usage && exit 2
[ -z "$COLOR" ] && usage && exit 2
ICON_BASE="/usr/share/folder-customizer/icons"
if [ -f "$ICON_BASE/$TONE/$COLOR.png" ]; then
    ICON_PATH="$ICON_BASE/$TONE/$COLOR.png"
else
    echo "Icon not found: $TONE/$COLOR.png" >&2; exit 3
fi
mkdir -p "$FOLDER"
cat > "$FOLDER/.directory" <<EOD
[Desktop Entry]
Icon=$ICON_PATH
EOD
[ -n "$TAG" ] && echo "Comment=$TAG" >> "$FOLDER/.directory"
echo "Applied icon to $FOLDER"
